= Azure Private Link
:experimental:
:description: Setting up Private Link on Azure

== Azure General Workflow

When you provision a new solution on TigerGraph Cloud, select the “Private“ or “Public and Private“ options to enable the . When they choose “Private“ or “Both“, they also need to fill in their subscription ID.

[tgcloud] An “Endpoint Service”(AWS) or “PrivateLink Service”(Azure) will be provisioned, a “Endpoint Service Name“ or “PrivateLink Service Name“ will be provided to customer. The subscription ID that user provided will be added to auto-approval allow list.

[User] Customer create “Endpoint”(AWS) or “Private Endpoint”(Azure) in their AWS/Azure account using the service name above.

[User] Customer confirm on tgcloud portal that their Endpoint has been created

[tgcloud] Endpoint connection will be automatically approved.

== Azure Customer Instructions
=== Private Endpoint
Verify that a dedicated subnet exists to contain the Private Endpoint and that network policies are disabled. For more information, see Disable network policies for private endpoints.

Navigate to the Azure portal. Search for Private Link and click Private Link.

Click Private endpoints and then click Add.

In the Resource section, select the Connect to an Azure resource by resource ID or alias for Connection Method, and fill in the Resource ID or Alias Field fields. The Request message value is optional.

Return to the Private endpoints section and allow a few minutes to wait. On approval, the Private Endpoint displays a CONNECTION STATE value of Approved.

=== Private DNS
To get the endpoint IP address, navigate to the Private Endpoint. Locate the Network Interface, copy the value for the Private IP address (i.e. 172.16.1.4).

image::dns-configuration.png[]

. Create a Private DNS Zone named tgcloud.io

. Select “Virtual Network Link” on the left, click “Add“, select the VNet that the Private Endpoint resides.

. Add an A record named {solutiondomain}.privatelink.i  (example: abcdefg.privatelink.i), the value is the private IP address from step 1.


image::add-a-record.png[]

